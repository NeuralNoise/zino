<html>
    <head>
        <title>In-site windows</title>
        <style type="text/css">
        html, body {
            width: 100%;
            height: 100%;
            margin: 0;
        }
        body {
            background-color: #ffffee;
        }
        div.puffin {
            border: 1px solid black;
            background-color: #eee;
            position: fixed;
        }
        </style>
        <script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js" charset="utf-8"></script>
        <script type="text/javascript">
            var Puffin = {
                create: function () {
                    var obj = {
                        div: null,
                        x: 0, y: 0, w: 0, h: 0, visible: false,
                        movable: true, moving: false,
                        move: function ( x, y ) {
                            // check window is wihtin boundaries
                            if ( x < 0 ) {
                                x = 0;
                            }
                            if ( y < 0 ) {
                                y = 0;
                            }
                            if ( x > this.maxx ) {
                                x = this.maxx;
                            }
                            if ( y > this.maxy ) {
                                y = this.maxy;
                            }
                            this.x = x;
                            this.y = y;
                            this.div.style.left = x + 'px';
                            this.div.style.top = y + 'px';
                        },
                        resize: function ( w, h ) {
                            this.w = w;
                            this.h = h;
                            this.div.style.width = w + 'px';
                            this.div.style.height = h + 'px';
                        },
                        hide: function () {
                            this.visible = false;
                            this.div.style.display = 'none';
                        },
                        show: function () {
                            this.visible = true;
                            this.div.style.display = 'block';
                        },
                        __construct: function () {
                            this.div = document.createElement( 'div' );
                            this.div.className = 'puffin';
                            this.div.onmousedown = ( function( me ) {
                                return function( e ) {
                                    if ( !e ) {
                                        e = window.event;
                                    }
                                    me.capture = [ e.clientX - me.x, e.clientY - me.y ];
                                    me.moving = true;
                                    me.maxx = $( window ).width() - me.w;
                                    me.maxy = $( window ).height() - me.h;
                                    return false;
                                };
                            } )( this );
                            var f = function () {};
                            if ( typeof document.body.onmouseup == 'function' ) {
                                var f = document.body.onmouseup;
                            }
                            document.body.onmouseup = ( function( me ) {
                                return function() {
                                    me.moving = false;
                                    f();
                                };
                            } )( this );
                            var f = function () {};
                            if ( typeof document.body.onmousemove == 'function' ) {
                                var f = document.body.onmousemove;
                            }
                            document.body.onmousemove = ( function( me ) {
                                return function( e ) {
                                    if ( !e ) {
                                        e = window.event;
                                    }
                                    if ( me.moving ) {
                                        me.move( e.clientX - me.capture[ 0 ], e.clientY - me.capture[ 1 ] );
                                    }
                                    f();
                                };
                            } )( this );
                            this.hide();
                            document.body.appendChild( this.div );
                        }
                    };
                    obj.__construct();
                    return obj;
                },
            };

        </script>
    </head>
    <body>
        <script type="text/javascript">
            var myWindow = Puffin.create();
            myWindow.move( 100, 100 );
            myWindow.resize( 200, 300 );
            myWindow.show();
        </script>
    </body>
</html>

